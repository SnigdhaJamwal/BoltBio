### Knowledge Graphs  

[Knowledge Graphs](https://www.ibm.com/cloud/learn/knowledge-graph#:~:text=A%20knowledge%20graph%2C%20also%20known,the%20term%20knowledge%20%E2%80%9Cgraph.%E2%80%9D) are a very useful method of representing information and have numerous applications. From Drug-target discovery to gene classification, they are becoming a very popular solution to such problems. This is because graphs can convey topological information, i.e., how various entities are related to one and other, and they can be used to create general-purpose embeddings that can be com- bined with various omics to enrich the information contained. Hence Knowledge Graphs have a powerful representational capacity. For our purposes, we used [Hetionet](https://het.io/), a biomedical heterogeneous knowledge graph.

**Case Study**

***Aim*** : Target Discovery via Link Prediction on Hetionet using Graph Neural Networks

***Introduction*** : 
Target discovery using Knowledge graphs is mainly done via link prediction. However, since Knowledge graphs are constructed using historical information, there is a chance they are still ’incomplete’. Hence the goal of link prediction is to complete this information gap using the present information of interactions. We use Hetionet to test our model. We aim to find new targets for existing diseases in Hetionet. This task can significantly impact the biomedical field, enabling the industry to better understand the susceptibility of patients to diseases. It can also help doctors better gauge the impact of a disease on the patient and prescribe more effective drugs in the future. We can achieve this by training a graph neural network to generate embeddings for given nodes and edges, which we can then use to measure the probability of an edge of a given type between two nodes.

***Present methods*** : There exist many methods for generating embeddings of a given path. DeepWalk, Node2vec, etc., are methods that establish paths in the graph and update embeddings accord- ingly. Node2Vec optimizes the embeddings by using random walks instead of BFS or DFS. First, it optimizes the transition probabilities and updates the latent vectors once the paths are established. OhmNet is a method that establishes paths using the metapath as described above.
Most methods presently used are for homogeneous graphs such as protein-protein or gene-gene interaction networks since heterogeneous graphs are very complex. Though there has been a rise in the number of methods that can pro- cess heterogeneous graphs, these are primarily in the non- biomedical field and cannot be directly translated to our use case. Hence we propose a novel architecture inspired by present popular graph neural networks such as the variational graph autoencoder and standard deep learning methods such as representation learning.

***Our proposal*** : 
The model essentially consists of graph convolutions and graph attention modules with custom message-passing layers. Message passing is how graph neural networks pass information from the neighbourhood of a node to that node. We implemented this using DGL, which allows users to write custom message-passing functions. We first pretrain the model on the complete knowledge graph to produce general-purpose embeddings. We use a contrastive learning approach to enforce the model to learn similar embeddings for nodes of similar types. After which, we take the Disease-Gene subgraph to train the neural network for link prediction. For prediction, after the model generates the embeddings, we take the potential source and target along with the proposed interaction and do a dot-product between the latent vectors to predict the score. The score is then passed through the sigmoid activation function to get the probability of whether that link exists or not. Along with the contrastive loss, we add the classification loss by taking only the positive samples from the graph and corresponding scores predicted by the model. This loss does not inhibit the model from learning new connections and promotes an understanding of valid links.

***Results*** : We obtained very high accuracy and F1 scores after training the model. We predicted approximately 300 new links in Het- ionet, which will now be verified in laboratories. Incorporating various omics data as described in supplementary image 8 can strengthen our results. We can easily concatenate them to our generated embeddings. New heterogeneous graph methods incorporate random walk methods in graph convolutions and show improved results, which is something we can incorporate in our method. Due to limited resources, we could not run the model at total capacity and had to sample a smaller graph rather the full Hetionet graph for predictions. We can expect more robust results once we get access to more resources.

